# v1.2.0 功能测试指南

## 🎯 测试环境

- **VS Code 版本**: >= 1.85.0
- **测试场景**: 多文件夹工作区
- **测试项目**: weipin, VitaSage, Omipay.userCenter

---

## ✅ 测试清单

### 1. 配置问题检查功能

#### 测试步骤
1. 打开多文件夹工作区 (Work.code-workspace)
2. 打开 Copilot Prompts 侧边栏
3. 点击顶部的 `⚠️ 检查配置问题` 按钮

#### 预期结果
- ✅ 显示问题列表快速选择框
- ✅ 检测到多个项目有配置文件的冲突警告
- ✅ 显示哪个项目的配置当前生效

#### 实际问题示例
```
⚠️ 检测到多个项目都有配置文件！
当前生效的是: weipin
其他项目 (Omipay.userCenter) 的配置可能不会生效。
```

---

### 2. 备份文件检测

#### 测试步骤
1. 在 `weipin/.github/` 创建 `copilot-instructions.md.backup`
2. 点击 `检查配置问题`

#### 预期结果
- ✅ 检测到备份文件
- ✅ 提供 "恢复备份" 选项
- ✅ 点击恢复后，备份文件重命名为 `copilot-instructions.md`

---

### 3. 自动应用功能（移除手动按钮）

#### 测试步骤
1. 勾选一个 Agent (例如 Vue 3 Agent)
2. 观察是否自动应用

#### 预期结果
- ✅ 立即显示 "配置已自动应用到当前项目 (1 个)"
- ✅ `.github/copilot-instructions.md` 文件更新
- ❌ 顶部不再显示"应用配置"按钮

---

### 4. 缺失配置检测

#### 测试步骤
1. 删除 VitaSage 的 `.github/copilot-instructions.md`
2. 点击 `检查配置问题`

#### 预期结果
- ✅ 检测到 VitaSage 缺失配置
- ✅ 提示 "VitaSage 未配置 copilot-instructions.md"

---

### 5. 多项目独立配置

#### 测试步骤
1. 在 VitaSage 中勾选 "Vue 3 Agent"
2. 切换到 Omipay.userCenter
3. 检查是否有配置文件

#### 预期结果
- ✅ VitaSage 有独立的配置文件
- ✅ Omipay.userCenter 可以有不同的配置
- ✅ 两个项目的配置互不影响

---

### 6. 界面按钮检查

#### 检查项
- ❌ 不应该有 "应用选中的配置 (项目)" 按钮
- ❌ 不应该有 "应用选中的配置 (全局)" 按钮
- ✅ 应该有 "⚠️ 检查配置问题" 按钮
- ✅ 应该有 "🔍 搜索" 按钮
- ✅ 应该有 "🔄 刷新" 按钮

---

## 🐛 已知问题修复验证

### 问题 1: weipin 配置影响所有项目

#### 原因
- 多文件夹工作区，weipin 是第一个文件夹
- 它的配置被 Copilot 应用到整个工作区

#### 修复验证
1. 运行 `检查配置问题`
2. 选择备份 weipin 的配置
3. 确认其他项目不再受影响

#### 预期结果
- ✅ weipin 的配置被备份
- ✅ VitaSage 可以使用自己的配置
- ✅ Omipay.userCenter 可以使用自己的配置

---

### 问题 2: 无法判断哪个配置生效

#### 修复验证
1. 点击状态栏的 "$(file-code) Copilot: X"
2. 查看当前项目的配置文件

#### 预期结果
- ✅ 打开当前项目的 `.github/copilot-instructions.md`
- ✅ 如果不存在，提示 "配置文件不存在"

---

## 📊 性能测试

### 检查性能

| 操作 | 预期时间 |
|------|---------|
| 点击检查按钮 | < 1s |
| 显示问题列表 | < 500ms |
| 勾选/取消勾选 | < 200ms |
| 自动应用配置 | < 1s |

---

## 🎨 用户体验测试

### 消息提示

- ✅ 勾选时: "✅ 配置已自动应用到当前项目 (X 个)"
- ✅ 全选时: "✅ 已全选并应用到当前项目 (X 个)"
- ✅ 清空时: "✅ 已清空并应用配置"
- ✅ 检查无问题: "✅ 未发现配置问题"

### 问题严重级别

- 🔴 **错误** (error): 阻止功能正常工作
- 🟡 **警告** (warning): 可能导致意外行为
- 🔵 **信息** (info): 提示性建议

---

## 🔧 故障排查

### 问题: 检查按钮点击无反应

**解决方法**:
```bash
# 1. 查看 VS Code 输出
Cmd + Shift + U → 选择 "Copilot Prompts Manager"

# 2. 重新编译插件
cd /path/to/vscode-extension
npm run compile

# 3. 重新安装
code --install-extension copilot-prompts-manager-1.2.0.vsix --force
```

### 问题: 配置检测不准确

**解决方法**:
```bash
# 手动检查配置文件
find /Users/pailasi/Work -name "copilot-instructions.md" -o -name "copilot-instructions.md.backup"
```

---

## ✅ 测试通过标准

- [ ] 所有 6 个功能测试通过
- [ ] 已知问题修复验证通过
- [ ] 性能测试达标
- [ ] 用户体验符合预期
- [ ] 无新增 Bug

---

## 📝 测试报告模板

```markdown
## 测试日期
2025-12-10

## 测试环境
- VS Code: 1.85.x
- 插件版本: 1.2.0
- 工作区: Work.code-workspace (3个项目)

## 测试结果
- [x] 配置问题检查功能 - 通过
- [x] 备份文件检测 - 通过
- [x] 自动应用功能 - 通过
- [x] 缺失配置检测 - 通过
- [x] 多项目独立配置 - 通过
- [x] 界面按钮检查 - 通过

## 发现问题
无

## 建议
建议在文档中增加多项目配置最佳实践
```

---

**测试负责人**: Forlear
**审核日期**: 2025-12-10
