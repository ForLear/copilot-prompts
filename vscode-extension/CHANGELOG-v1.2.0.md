# Changelog - v1.2.0

## 🎯 核心改进

### ✅ 新增功能

1. **配置问题检查器**
   - 新增 `检查配置问题` 按钮（警告图标⚠️）
   - 自动检测多文件夹工作区的配置冲突
   - 检测备份文件并提供一键恢复
   - 检测缺失的配置文件
   - 智能诊断和快速修复建议

2. **配置冲突检测**
   - 自动识别多项目工作区中的配置冲突
   - 提示哪个项目的配置当前生效
   - 快速备份第一个项目的配置以避免干扰

### 🔧 功能优化

1. **移除全局应用功能**
   - ❌ 移除了顶部的 `应用选中的配置 (项目)` 按钮
   - ❌ 移除了顶部的 `应用选中的配置 (全局)` 按钮
   - ✅ 勾选/取消勾选时自动应用到当前项目
   - ✅ 避免全局配置影响所有项目

2. **自动应用机制**
   - 勾选 checkbox 后立即应用配置到当前项目
   - 全选/清空操作自动应用
   - 减少手动点击，提升效率

### 🐛 问题修复

1. **解决多文件夹工作区配置冲突**
   - 修复第一个文件夹的配置影响所有项目的问题
   - 每个项目现在使用独立的配置文件
   - 备份机制防止误删配置

2. **配置作用范围清晰化**
   - 配置只应用到当前激活的工作区文件夹
   - 提示信息明确指出配置位置

---

## 📋 使用指南

### 新功能：配置问题检查

1. **打开侧边栏**: 点击 Copilot Prompts 图标
2. **点击检查按钮**: 顶部工具栏的 `⚠️` 图标
3. **查看问题**: 会显示所有检测到的问题
4. **快速修复**: 选择问题可执行自动修复

### 检查项目

- ✅ **多文件夹工作区冲突**: 检测是否有多个项目都有配置，导致只有第一个生效
- ✅ **备份文件**: 检测 `.backup` 文件，提供一键恢复
- ✅ **缺失配置**: 提示哪些项目还没有配置

---

## 🔍 问题诊断示例

### 问题 1: 工作区配置冲突

```
⚠️ 检测到多个项目都有配置文件！
当前生效的是: weipin
其他项目 (VitaSage, Omipay.userCenter) 的配置可能不会生效。
建议：每个项目使用独立配置，避免冲突。

[查看详情] 按钮 → 显示所有项目的配置路径
```

### 问题 2: 备份文件

```
ℹ️ 发现备份文件: weipin/.github/copilot-instructions.md.backup
如需恢复，可以重命名回 copilot-instructions.md

[恢复备份] 按钮 → 一键恢复配置
```

### 问题 3: 缺失配置

```
ℹ️ VitaSage 未配置 copilot-instructions.md
建议：为此项目单独配置 Copilot Prompts

[立即配置] 按钮 → 打开配置管理器
```

---

## 🎨 界面变化

### 之前 (v1.1.0)
```
顶部工具栏: ✓项目 ✓全局 🔍搜索 🔄刷新
```

### 现在 (v1.2.0)
```
顶部工具栏: ⚠️检查问题 🔍搜索 🔄刷新
```

---

## 💡 最佳实践

### 多项目工作区配置

1. **为每个项目独立配置**
   ```
   /project-A/.github/copilot-instructions.md  ← Vue 2 配置
   /project-B/.github/copilot-instructions.md  ← Vue 3 配置
   /project-C/.github/copilot-instructions.md  ← React 配置
   ```

2. **使用检查功能定期诊断**
   - 添加新项目后，运行一次检查
   - 配置不生效时，运行检查查找原因

3. **备份重要配置**
   - 插件会自动创建 `.backup` 文件
   - 可以随时恢复

---

## 🚀 升级方法

### 从 v1.1.0 升级

```bash
cd /path/to/copilot-prompts/vscode-extension
npm run compile
vsce package
code --install-extension copilot-prompts-manager-1.2.0.vsix --force
```

### 重新加载 VS Code
```
Cmd + Shift + P → Developer: Reload Window
```

---

## 📝 技术细节

### 新增文件

- `src/configValidator.ts` - 配置验证器模块

### 修改文件

- `package.json` - 更新命令和版本号
- `src/extension.ts` - 集成检查功能，移除全局应用
- `src/promptsProvider.ts` - 保持不变
- `src/configManager.ts` - 保持不变

### 新增命令

- `copilotPrompts.checkIssues` - 检查配置问题

### 移除命令

- ~~`copilotPrompts.applyGlobal`~~ - 保留用于向后兼容，实际调用项目级应用

---

## 🎯 下一步计划 (v1.3.0)

- [ ] 添加配置模板市场
- [ ] 支持自定义 Prompts 路径
- [ ] 配置版本控制和历史记录
- [ ] 团队配置共享功能

---

**发布日期**: 2025-12-10
**作者**: Forlear
